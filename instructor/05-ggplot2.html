<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Data Empowerment for Election Workers: Data Visualisation with ggplot2</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/edi-plej/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/edi-plej/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/edi-plej/favicon-16x16.png"><link rel="manifest" href="../favicons/edi-plej/site.webmanifest"><link rel="mask-icon" href="../favicons/edi-plej/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav edi-plej"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="edi-plej-logo" alt="Engineering For Democracy and Partnership for Large Election Jurisdictions" src="../assets/images/edi-plej-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../05-ggplot2.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav edi-plej" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Engineering For Democracy and Partnership for Large Election Jurisdictions" src="../assets/images/edi-plej-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Data Empowerment for Election Workers
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Data Empowerment for Election Workers
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html"></a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Empowerment for Election Workers
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 64%" class="percentage">
    64%
  </div>
  <div class="progress edi-plej">
    <div class="progress-bar edi-plej" role="progressbar" style="width: 64%" aria-valuenow="64" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../05-ggplot2.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-intro.html">1. Before we Start</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-intro-to-r.html">2. Introduction to R</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-starting-with-data.html">3. Starting with Data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-dplyr.html">4. Data Wrangling with dplyr</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-tidyr.html">5. Data Wrangling with tidyr</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        6. Data Visualisation with ggplot2
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#visualization-options-in-r">Visualization Options in R</a></li>
<li><a href="#plotting-with-ggplot2">Plotting with <strong><code>ggplot2</code></strong></a></li>
<li><a href="#building-your-plots-iteratively">Building Your Plots Iteratively</a></li>
<li><a href="#boxplot">Boxplot</a></li>
<li><a href="#bar-plot">Bar Plot</a></li>
<li><a href="#customization">Customization</a></li>
<li><a href="#plot-output">Plot Output</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="06-rmarkdown.html">7. Getting Started with R Markdown (optional)</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html"></a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/04-tidyr.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/06-rmarkdown.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/04-tidyr.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Data Wrangling with
        </a>
        <a class="chapter-link float-end" href="../instructor/06-rmarkdown.html" rel="next">
          Next: Getting Started with...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Data Visualisation with ggplot2</h1>
        <p>Last updated on 2025-11-12 |

        <a href="https://github.com/EngineeringForDemocracy/r-election-workers/edit/main/episodes/05-ggplot2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 115 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<ul><li>This episode is a broad overview of ggplot2 and focuses on getting
familiar with the layering system of ggplot2, using the argument
<code>group</code> in the <code>aes()</code> function, and basic
customization of the plots.</li>
<li>We’ll show how to visualize patterns in check-in behavior across
different locations and devices, and introduce mapping techniques.</li>
</ul></div>
</div>
</div>
</div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What are the components of a ggplot?</li>
<li>How can I visualize check-in patterns over time?</li>
<li>How can I compare check-in frequencies across locations and
devices?</li>
<li>What are the main differences between R base plots, lattice, and
ggplot?</li>
<li>How can I visualize location data on maps with ggplot2?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Produce scatter plots, box plots, and bar plots using ggplot.</li>
<li>Create time series plots for temporal check-in data.</li>
<li>Set universal plot settings.</li>
<li>Describe what faceting is and apply faceting in ggplot.</li>
<li>Modify the aesthetics of an existing ggplot plot (including axis
labels and color).</li>
<li>Build complex and customized plots from data in a tibble.</li>
<li>Create maps with ggplot2 to visualize location-based data.</li>
<li>Recognize the differences between base R, lattice, and ggplot
visualizations.</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>We start by loading the required packages:
<strong><code>tidyverse</code></strong> and
<strong><code>lubridate</code></strong>. As you may recall,
<strong><code>ggplot2</code></strong> is included in the
<strong><code>tidyverse</code></strong> package, so we do not need to
load <strong><code>ggplot2</code></strong> in separately.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">here</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span> </span></code></pre>
</div>
<p>Next, let’s load in our data! Throughout this lesson, we will be
using a sampled version of the data we created at the end of “Starting
With Data”. In practice, sampling data before visualization is NOT
required; however, due to the size of our original data set, using a
smaller, sampled data set will allow us to generate plots much
faster!</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"checkin_sample_plotting.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Before we continue, let’s take a look at the structure and size of
our data set to see what we’ll be working with in detail:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in glimpse(data): could not find function "glimpse"</code></pre>
</div>
<p>As you may notice, the house exceeds 12, meaning this data is in 24
hour time! If you are unfamiliar, this means 13 represents 1PM, 14
represents 2PM, and so on.</p>
<p>Additionally, for those curious, the original data set had
approximately 352k lines, which means this data set is less than 10% of
the size!</p>
<section><h2 class="section-heading" id="visualization-options-in-r">Visualization Options in R<a class="anchor" aria-label="anchor" href="#visualization-options-in-r"></a></h2>
<hr class="half-width"><p>Before we start with <strong><code>ggplot2</code></strong>, it’s
helpful to know that there are several ways to create visualizations in
R. While <strong><code>ggplot2</code></strong> is great for building
complex and highly customizable plots, there are simpler and quicker
alternatives that you might encounter or use depending on the context.
Let’s briefly explore a few of them:</p>
<div class="section level3">
<h3 id="base-r-plots">Base-R Plots<a class="anchor" aria-label="anchor" href="#base-r-plots"></a></h3>
<p>Base R plots are the simplest form of visualization and are great for
quick, exploratory analysis. You can create plots with very little code,
but customizing them can be cumbersome compared to
<strong><code>ggplot2</code></strong>.</p>
<p>Example of a simple <span class="glosario_def"><a href="https://glosario.carpentries.org/en/#time_series" class="external-link">time
series</a></span> plot in base R showing the number of check-ins by
hour:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hourly_counts</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>                 <span class="fu">count</span><span class="op">(</span><span class="va">hour</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">hourly_counts</span><span class="op">$</span><span class="va">hour</span>, <span class="va">hourly_counts</span><span class="op">$</span><span class="va">n</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Base R Plot: Check-Ins by Hour"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Hour of Day"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of Check-Ins"</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span>  <span class="co">#'l' for line</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="lattice"><strong><code>Lattice</code></strong><a class="anchor" aria-label="anchor" href="#lattice"></a></h3>
<p>Lattice is another plotting system in R, which allows for creating
multi-panel plots easily. It’s different from ggplot2 because you define
the entire plot in a single function call, and modifications after
plotting are limited.</p>
<p>Example of a lattice plot showing check-ins by device for different
locations:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">lattice</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#grabs specific locations (so the graph isn't giant) and converts locations + devices to factors</span></span>
<span><span class="va">checkins_lattice</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>                    <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                    <span class="co">#we're removing "DEVICE_" because it causes overlap within the plot</span></span>
<span>                    <span class="co">#if you're curious, remove this line and regenerate the plot!</span></span>
<span>                    <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                    <span class="fu">mutate</span><span class="op">(</span></span>
<span>                      device <span class="op">=</span> <span class="fu">as.factor</span><span class="op">(</span><span class="va">device</span><span class="op">)</span>,</span>
<span>                      location <span class="op">=</span> <span class="fu">as.factor</span><span class="op">(</span><span class="va">location</span><span class="op">)</span></span>
<span>                    <span class="op">)</span></span>
<span></span>
<span><span class="co">#creates a lattice boxplot (bwplot)</span></span>
<span><span class="fu">bwplot</span><span class="op">(</span><span class="va">hour</span> <span class="op">~</span> <span class="va">device</span> <span class="op">|</span> <span class="va">location</span>, data <span class="op">=</span> <span class="va">checkins_lattice</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Lattice Plot: Check-in Hour Distribution by Device and Location"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Device"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Hour of Check-in"</span>,</span>
<span>       layout <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">checkins_lattice</span><span class="op">$</span><span class="va">location</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co">#adjusts layout for multiple locations</span></span>
<span>       strip <span class="op">=</span> <span class="fu">strip.custom</span><span class="op">(</span>bg<span class="op">=</span><span class="st">"lightgrey"</span><span class="op">)</span>,</span>
<span>       scales <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>at <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span><span class="op">)</span>, <span class="co">#adds all hours on y, not just even numbers</span></span>
<span>       panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>         <span class="fu">panel.bwplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span></span>
<span>       <span class="op">}</span><span class="op">)</span></span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="plotting-with-ggplot2">Plotting with <strong><code>ggplot2</code></strong>
<a class="anchor" aria-label="anchor" href="#plotting-with-ggplot2"></a></h2>
<hr class="half-width"><p><strong><code>ggplot2</code></strong> is a plotting package that
makes creating complex plots from data stored in a tibble simpler. It
provides a programmatic interface for specifying what variables to plot,
how they are displayed, and general visual properties. As a result, if
the underlying data changes or if we decide to switch from a bar plot to
a scatter plot, we only have to make minimal adjustments to the
code!</p>
<p><strong><code>ggplot2</code></strong> functions work best with data
in the ‘long’ format. As you may recall from “Data Wrangling with
tidyr”, this consists of a column for every dimension, and a row for
every observation. Ensuring you use well-structured data will save you
lots of time when making figures with
<strong><code>ggplot2</code></strong></p>
<p><strong><code>ggplot2</code></strong> graphics are built step by step
by adding new elements. Adding layers in this fashion allows for
extensive flexibility and customization of plots.</p>
<p>Each chart built with <strong><code>ggplot2</code></strong> must
include the following: - Data - Aesthetic mapping (aes) - Describes how
variables are mapped onto graphical attributes - Visual attribute of
data including x-y axes, color, fill, shape, and alpha - Geometric
objects (geom) - Determines how values are rendered graphically, as bars
(<code>geom_bar</code>), scatterplot (<code>geom_point</code>), line
(<code>geom_line</code>), etc.</p>
<p>Thus, the template for graphic in ggplot2 is:</p>
<pre><code>&lt;DATA&gt; %&gt;%
    ggplot(aes(&lt;MAPPINGS&gt;)) +
    &lt;GEOM_FUNCTION&gt;()</code></pre>
<p>Remember that the pipe operator <code>%&gt;%</code> places the result
of the previous line(s) into the first argument of the function. The
<strong><code>ggplot</code></strong> function expects a data frame to be
the first argument, which allows us to change from specifying the
<code>data =</code> argument within the <code>ggplot</code> function to
instead piping the data into the function.</p>
<p>To create a chart with <strong><code>ggplot2</code></strong>, follow
the steps below:</p>
<ol style="list-style-type: decimal"><li>use the <code>ggplot()</code> function and bind the plot to a
specific tibble.</li>
</ol><div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal"><li>Using the aesthetic (<code>aes</code>) function, define your mapping
by selecting the variables to be plotted and specifying how to present
them in the graph, e.g. as x/y positions or characteristics such as
size, shape, color, etc.</li>
</ol><div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">precinct</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal"><li>Add ‘geoms’ – graphical representations of the data in the plot
(points, lines, bars). <strong><code>ggplot2</code></strong> offers many
different geoms; we will use some common ones today, including:
<ul><li>
<code>geom_bar()</code> for counting observations in categories</li>
<li>
<code>geom_histogram()</code> for showing distributions</li>
<li>
<code>geom_boxplot()</code> for statistical summaries</li>
<li>
<code>geom_line()</code> for trend lines, time series, etc.</li>
</ul></li>
</ol><p>To add a geom to the plot use the <code>+</code> operator. Let’s
start by creating a bar chart showing the distribution of check-ins
across precincts:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">precinct</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>The <code>+</code> in the <strong><code>ggplot2</code></strong>
package is particularly useful because it allows you to modify existing
<code>ggplot</code> objects. This means you can easily set up plot
templates and conveniently explore different types of plots! Using this
idea, the above plot can also be generated with code like this, similar
to the “intermediate steps” approach:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#assign the plot to a variable</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">precinct</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#draw the plot as a bar plot</span></span>
<span><span class="va">plot</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div id="notes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="notes" class="callout-inner">
<h3 class="callout-title">Notes</h3>
<div class="callout-content">
<ul><li>Anything you put in the <code>ggplot()</code> function can be seen
by any geom layers that you add (i.e., these are universal plot
settings). This includes the x- and y-axis mapping you set up in
<code>aes()</code>.</li>
<li>You can also specify mappings for a given geom independently of the
mapping defined globally in the <code>ggplot()</code> function.</li>
<li>The <code>+</code> sign used to add new layers must be placed at the
end of the line containing the <em>previous</em> layer. If, instead, the
<code>+</code> sign is added at the beginning of the line containing the
new layer, <strong><code>ggplot2</code></strong> will not add the new
layer and will return an error message.</li>
</ul><div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## This is the correct syntax for adding layers</span></span>
<span><span class="va">checkins_plot</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## This will not add the new layer and will return an error message</span></span>
<span><span class="va">checkins_plot</span></span>
<span><span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="building-your-plots-iteratively">Building Your Plots Iteratively<a class="anchor" aria-label="anchor" href="#building-your-plots-iteratively"></a></h2>
<hr class="half-width"><p>Building plots with <strong><code>ggplot2</code></strong> is
typically an iterative process. We start by defining the data set we’ll
use, lay out the axes, and choose a geom.</p>
<p>Let’s re-create the time-series plot we made for the Base-R
demonstration:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#using the hourly_counts we created, generate a time-series plot</span></span>
<span><span class="va">hourly_counts</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="co">#creates a line plot using the x and y from the ggplot above!</span></span></code></pre>
</div>
<p>Now that we have a baseline plot to start from, we can start
modifying it to extract additional information! For instance, when
inspecting the plot, we can notice that it’s a bit difficult to tell at
first glance where each hour sits on the line.</p>
<p>To resolve this, we will add points to the line to clearly indicate
each hour:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hourly_counts</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Next, we will add colors for all of the points by specifying a
<code>color</code> argument inside the <code>geom_point</code>
function:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hourly_counts</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre>
</div>
<p>To color each point in the plot differently, you <em>could</em> use a
vector as an input to the <code>color</code> argument; however, because
we are now mapping features of the data to a color, instead of setting
one color for all points, the color of the points now needs to be set
inside a call to the <code>aes</code> function. When we map a variable
in our data to the color of the points,
<strong><code>ggplot2</code></strong> will provide a different color
corresponding to the different values of the variable.</p>
<p>Let’s apply this to our plot below, changing the color of each point
based on the hour:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hourly_counts</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Unfortunately, this doesn’t tell us much about our data, just that
each point represents a different hour (which we already knew!).
Additionally, you may notice that after adding conditional coloring
using <code>aes()</code>, ggplot automatically added a legend to explain
what the different colors represent/mean!</p>
<p>Now, instead of coloring each point based on one of the variables we
already have, we’re going to calculate the average hourly count and set
the point to green if the count at that hour is <em>above</em> average
and red if the count at that hour is <em>below</em> average!</p>
<p>To do this, we will calculate the average hourly count and, using
mutate, add a column to our hourly_counts tibble that indicates whether
the count at that hour is above or below the calculated average! Then,
we will use the <code>scale_color_manual</code> function to manually
color these points green and red instead of the default (which, when
writing this lesson, was red and blue, respectively).</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#calculate average</span></span>
<span><span class="va">average</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">hourly_counts</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#plot</span></span>
<span><span class="va">hourly_counts</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>avg_color <span class="op">=</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="va">average</span>, <span class="st">"Above"</span>, <span class="st">"Below"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#adds the additional column</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">avg_color</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#colors the points</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Above"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"Below"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="co">#chooses the colors</span></span></code></pre>
</div>
<p>Additionally, you may want to increase the size of the points! This
can be accomplished using the <code>size</code> argument within the
<code>geom_point</code> function, as seen below:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#calculate average</span></span>
<span><span class="va">average</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">hourly_counts</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#plot</span></span>
<span><span class="va">hourly_counts</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>avg_color <span class="op">=</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="va">average</span>, <span class="st">"Above"</span>, <span class="st">"Below"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#adds the additional column</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">avg_color</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="co">#colors the points</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Above"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"Below"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="co">#chooses the colors</span></span></code></pre>
</div>
<p>At this point, our plot is mostly completed! The only remaining issue
is the lack of proper titling and labeling.</p>
<p>By default, the axes labels on a plot are determined by the name of
the variable being plotted. However,
<strong><code>ggplot2</code></strong> offers lots of customization
options, like specifying the axes labels and adding a title to the plot,
with relatively few lines of code. We will add more informative x-and
y-axis labels to our plot, a more explanatory label to the legend, and a
plot title.</p>
<p>The <code>labs</code> function takes the following arguments:</p>
<ul><li>
<code>title</code> – to produce a plot title</li>
<li>
<code>subtitle</code> – to produce a plot subtitle (smaller text
placed beneath the title)</li>
<li>
<code>caption</code> – a caption for the plot</li>
<li>
<code>...</code> – any pair of name and value for aesthetics used in
the plot (e.g., <code>x</code>, <code>y</code>, <code>fill</code>,
<code>color</code>, <code>size</code>)</li>
</ul><div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hourly_counts</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>avg_color <span class="op">=</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="va">average</span>, <span class="st">"Above"</span>, <span class="st">"Below"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">avg_color</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Above"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"Below"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Check-In Count per Hour"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Relation to Average"</span><span class="op">)</span></span></code></pre>
</div>
<p>Our final step will be to improve the x-axis to include <em>all</em>
hours, not just 10, 15, and 20! This can be achieved using the
<code>scale_x_continuous</code> function.</p>
<p>The <code>scale_x_continuous</code> function is used to customize the
x-axis when the x-axis is numeric (or continuous!). Within this
function, you can control the axis limit (or range) and breaks (where
tick marks appear).</p>
<p>Let’s finish our plot using this function:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hourly_counts</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>avg_color <span class="op">=</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="va">average</span>, <span class="st">"Above"</span>, <span class="st">"Below"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">avg_color</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Above"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"Below"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Check-In Count per Hour"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Relation to Average"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>While the plot above gives information on the number of check-ins
across <em>all</em> locations, we may want information unique to
individual locations instead. To achieve this, using the information
above, we can calculate the amount of check-ins every hour and add a
line for each of the first five locations below:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#calculate check-ins per hour for each location</span></span>
<span><span class="va">hourly_count</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">location</span>, <span class="va">hour</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#plot multiple lines, changing the color for each</span></span>
<span><span class="va">hourly_count</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">n</span>, color <span class="op">=</span> <span class="va">location</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#Note: putting color in ggplot applies to all plots (geom_line AND geom_point)!</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Hourly Check-In Count by Location"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Location"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>As you can see, LOCATION_003 is very popular at 10AM (and may benefit
from additional support from employees/volunteers), whereas LOCATION_002
dies down after 11AM.</p>
</section><section><h2 class="section-heading" id="boxplot">Boxplot<a class="anchor" aria-label="anchor" href="#boxplot"></a></h2>
<hr class="half-width"><p>We can use box plots to visualize the distribution of check-in times
for specific locations:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre>
</div>
<p>As you may notice, it’s a bit difficult to understand this plot at
first glance! To resolve this, let’s begin by adding all of the hours on
the y-axis using the <code>scale_y_continuous</code> function! This
function behaves the exact same as the <code>scale_x_continuous</code>
function, but it applies to the y-axis instead:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">23</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<p>By adding points to a box plot, we can have a better idea of the
number of measurements and of their distribution:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">23</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Looking at this plot, from a rough estimate, it looks like there are
far fewer dots on the plot than there rows in our tibble. This should
lead us to believe that there may be multiple observations plotted on
top of each other (e.g. three observations where <code>hour</code> is 12
and <code>location</code> is LOCATION_001). This is known as
“overplotting” and occurs when multiple data points share the same x and
y coordinates.</p>
<p>There are two main ways to alleviate overplotting issues: 1. changing
the transparency of the points 2. jittering the location of the
points</p>
<p>Let’s first explore option 1, or changing the transparency of the
points. When we say “transparency”, we mean the opacity/your ability to
see through the point. We can control the transparency of the points
with the <code>alpha</code> argument! Values of <code>alpha</code> range
from 0 to 1, with lower values corresponding to more transparent colors
(an <code>alpha</code> of 1 is the default value). Specifically, an
alpha of 0.1, would make a point one-tenth as opaque as a normal point.
Stated differently ten points stacked on top of each other would
correspond to a normal point.</p>
<p>With that being said, we’re going to change the <code>alpha</code> to
0.5. in an attempt to help fix the overplotting. As you may quickly
notice, the overplotting is not solved, but adding transparency begins
to address this problem, as the points where there are more overlapping
observations are darker (as opposed to lighter red):</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">23</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Since that only helped a little bit with the overplotting problem,
let’s try option two and jitter the points on the plot, allowing us to
see each point. This is due to jittering introducing a little bit of
randomness into the position of our points. You can think of this
process as taking the overplotted graph and giving it a tiny shake! The
points will move a little bit side-to-side and up-and-down, but their
position in comparison to the original plot won’t dramatically
change.</p>
<p>Note that this solution is only suitable for plotting integer
figures! For numeric figures with decimals, geom_jitter() becomes
inappropriate because it obscures the true value of the observation.</p>
<p>We can jitter our points using the <code>geom_jitter()</code>
function instead of the <code>geom_point()</code> function, as seen
below:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">23</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>As you can see, the points have been moved dramatically! Thankfully,
the <code>geom_jitter()</code> function allows for us to specify the
amount of random motion in the jitter by using the <code>width</code>
and <code>height</code> arguments. When we don’t specify values for
<code>width</code> and <code>height</code>, <code>geom_jitter()</code>
defaults to 40% of the resolution of the data (the smallest change that
can be measured). Hence, if we would like <em>less</em> spread in our
jitter than the default, we should pick values between 0.1 and 0.4.
Experiment with the values to see how your plot changes!</p>
<p>Here, we initially chose a height of 0.05 (as too much variation in
height may suggest different times at first glance) and a width of
0.2:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, height <span class="op">=</span> <span class="fl">0.05</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">23</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>For our final step, let’s add a title, appropriate labels, and
improve the visuals of the plot overall! Additionally, to clean the
location names on the x-axis, we’ll be using the <code>mutate</code>
function (recall from Data Wrangling with dplyr) to remove the
“LOCATION_” prefix from each name (since the axis label will indicate
that these are locations!):</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#removes prefix</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, height <span class="op">=</span> <span class="fl">0.05</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">23</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co">#adds labels to the plot</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Check-in Times by Location"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Hour (24-hour Format)"</span><span class="op">)</span></span></code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Box plots are useful summaries, but hide the <em>shape</em> of the
distribution. For example, if the distribution is bi-modal, we would not
see it in a box plot. An alternative to the box plot is the violin plot,
where the shape (of the density of points) is drawn.</p>
<p>Start by replacing the box plot with a violin plot; see
<code>geom_violin()</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, height <span class="op">=</span> <span class="fl">0.05</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">23</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Check-in Times by Location"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Hour (24-hour Format)"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<p>So far, we’ve looked at the distribution of check-in times between
locations. Next, you’re going to try making a new plot to explore the
distribution of another variable between locations.</p>
<p>Create a box plot for <code>minute</code> for the locations above.
Overlay a jitter layer to on the box plot layer to display the
distributions more accurately. Feel free to select any fill, color,
alpha, height, and width! Ensure a title and proper axis labels are
added.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">minute</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"navy"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, height <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Check-in Minutes by Location"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Minute of Check-in"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<p>Lastly, color each point according to the device used! Ensure you
change the name of the legend as well and remove “DEVICE_” from all
device names (to ensure a clean legend).</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">minute</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">device</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Check-in Minutes by Location"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Minute of Check-in"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="bar-plot">Bar Plot<a class="anchor" aria-label="anchor" href="#bar-plot"></a></h2>
<hr class="half-width"><p>Bar plots are great for visualizing categorical data, such as
counting the number of check-ins per device, per location, or per
precinct. By default, <code>geom_bar</code> accepts a variable for x,
and plots the number of instances of each value of x (in this case,
location) within the data set.</p>
<p>Let’s create a bar plot displaying check-in counts for the first five
locations:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Check-In Count by Location"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code></pre>
</div>
<p>Next, let’s use the <code>fill</code> aesthetic for the
<code>geom_bar()</code> geom to color bars by the device used for
check-in:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Check-In Count by Location"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span></span></code></pre>
</div>
<p>This creates a stacked bar chart. Unfortunately, as you may notice,
this is a bit difficult to read. Instead, we can separate the portions
of the stacked bar that correspond to each device and put them
side-by-side by using the <code>position</code> argument for
<code>geom_bar()</code> and setting it to “dodge”.</p>
<p>Let’s apply this concept to the code below, changing the title for
clarity:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Count of Check-Ins by Location for Each Device"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span></span></code></pre>
</div>
<p>As you can see, this is much easier to read and interpret!</p>
<p>In some cases, we may be more interested in the <em>proportion</em>
of each individual device at each location rather than the actual
<em>count</em> of each device. Proportions are helpful because they
account for differences in sample sizes, and instead focus on
distribution within specific locations! To compare proportions, we will
first create a new tibble (<code>prop_device</code>) with a new column
named “prop”, representing the percent of each device within each
location.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prop_device</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">location</span>, <span class="va">device</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">location</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>prop <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu">sum</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Now, we can use this new tibble to create our plot showing the
<em>proportion</em> of each device at each location! When creating your
plot, ensure you include <code>y = prop</code> within the initial ggplot
call AND <code>stat = "identity"</code> to tell ggplot to use the y
values instead of the count, and adjust labels/titles for clarity:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prop_device</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">prop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Proportion of Check-Ins by Location for Each Device"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span></span></code></pre>
</div>
<p>Looking at this graph, we can see that all of the devices (except
DEVICE_012) have similar proportions (aka. usage rates) when sample
sizes are taken into consideration!</p>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>If you’d prefer to visualize percentages instead of proportions, you
can multiply the prop column by 100! For example:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prop_device</span> <span class="op">&lt;-</span> <span class="va">prop_device</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>prop <span class="op">=</span> <span class="op">(</span><span class="va">prop</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>If you adjust to percentages, however, please ensure you adjust
titles and axis labels accordingly!</p>
</div>
</div>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Using the information you learned above, create a bar plot showing
the proportion (or percentages, if you’d like) of check-ins by hour for
the first four devices (ie. “DEVICE_001”, “DEVICE_002”, “DEVICE_003”,
and “DEVICE_004”). Which hours had the highest proportion of check-ins
from DEVICE_001 and DEVICE_002?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#calculate proportions</span></span>
<span><span class="va">prop_hour_device</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">device</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"DEVICE_001"</span>, <span class="st">"DEVICE_002"</span>, <span class="st">"DEVICE_003"</span>, <span class="st">"DEVICE_004"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">hour</span>, <span class="va">device</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">hour</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>prop <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu">sum</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#generate plot</span></span>
<span><span class="va">prop_hour_device</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Proportion of Check-Ins by Hour for Each Device"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co">#note: you can remove 6 and 20 by using this line instead: </span></span>
<span>  <span class="co">#scale_x_continuous(breaks = seq(7, 19, by = 1))</span></span></code></pre>
</div>
<p>From this plot, we can identify that DEVICE_001 has the highest
proportion at 7:00/7AM and DEVICE_002 has the highest proportion at
19:00/7PM.</p>
</div>
</div>
</div>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<div id="challenge-exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="challenge-exercise" class="callout-inner">
<h3 class="callout-title">Challenge Exercise</h3>
<div class="callout-content">
<p>Create a bar plot showing the check-in counts for the ten devices
with the highest number of check-ins. Color each bar according to the
device, title it appropriately, and use proper axis labels!</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#retrieve top devices</span></span>
<span><span class="va">top_devices</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">device</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">top_n</span><span class="op">(</span><span class="fl">10</span>, <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">device</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#create plot</span></span>
<span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">device</span> <span class="op">%in%</span> <span class="va">top_devices</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">device</span>, fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Top 10 Devices by Number of Check-ins"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Device"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="faceting" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="faceting" class="callout-inner">
<h3 class="callout-title">Faceting</h3>
<div class="callout-content">
<p>Rather than creating a single plot with side-by-side bars for each
device, we may want to create multiple plots, where each plot shows the
data for a single device. This would be especially useful if we had a
large number of devices that we had sampled (like 5 or 10), as
side-by-side bars become harder to read as the number of bars
increase.</p>
<p><strong><code>ggplot2</code></strong> has a special technique called
<em>faceting</em> that allows the user to split one plot into multiple
plots based on a factor included in the data set. Below, we can use this
technique to split our bar plot of check-in proportions by hour for each
device so each device has its own panel:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#generate plot</span></span>
<span><span class="va">prop_hour_device</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Proportion of Check-Ins by Hour for Each Device"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">device</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="co">#here, we specify we want to facet wrap by device</span></span></code></pre>
</div>
<p>You can click the “Zoom” button in your RStudio plots panel to view a
larger version of this plot.</p>
<p>Usually plots with white background look more readable when printed.
We can set the background to white using the function
<code>theme_bw()</code>. Additionally, we can remove the grid:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prop_hour_device</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Proportion of Check-Ins by Hour for Each Device"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">device</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>We can also facet by location to see patterns of device proportions
within different locations:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#creates new data using location information</span></span>
<span><span class="va">prop_hour_device_loc</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">device</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"DEVICE_001"</span>, <span class="st">"DEVICE_002"</span>, <span class="st">"DEVICE_003"</span>, <span class="st">"DEVICE_004"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">hour</span>, <span class="va">location</span>, <span class="va">device</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">hour</span>, <span class="va">location</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#this specifies to calculate within locations as well</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>prop <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu">sum</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#generates plot</span></span>
<span><span class="va">prop_hour_device_loc</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Hourly Distribution of Device Check-Ins, Faceted by Location"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">location</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Looking at the graph above, we can see that at LOCATION_001, devices
have varying rates of usage throughout the day, and at LOCATION_002,
devices are often used the same amount!</p>
<div class="section level2">
<h2 id="histograms">Histograms<a class="anchor" aria-label="anchor" href="#histograms"></a></h2>
<p>When working with election data, understanding the distribution of
check-ins over time is crucial! As seen above, bar plots allow us to
look at general peaks and overall trends using the <code>hour</code>
variable. However, if we wanted to look at the distribution of check-ins
at a more detailed level (like by minute intervals), bar plots become
much less effective.</p>
<p>In these cases, <span class="glosario_def"><a href="https://glosario.carpentries.org/en/#histogram" class="external-link">histograms</a></span>
are more appropriate to use! This is due to histograms’unique ability to
allow for the sorting of continuous variables into bins, making it
easier to identify trends.</p>
<p>First, let’s look at the bar chart below:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Check-In Distribution by Hour"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code></pre>
</div>
<p>Now, let’s create a similar plot displaying the distribution of
check-ins by hour using a histogram instead of a bar plot:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Check-In Distribution by Hour"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code></pre>
</div>
<p>As you may see, the plots look almost identical, save for the
histogram having bars that touch (since the data is continuous and not
discrete/categorical).</p>
<p>With histograms, however, we can create a more granular view by using
smaller bins:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create a decimal representation of the data (hour + minutes)</span></span>
<span><span class="va">checkins_with_dec_hour</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>dec_hour <span class="op">=</span> <span class="va">hour</span> <span class="op">+</span> <span class="va">minute</span><span class="op">/</span><span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#plot with 15 minute bins (0.25 minute bins)</span></span>
<span><span class="va">checkins_with_dec_hour</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dec_hour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, binwidth <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Check-In Distribution by Hour (15-Minute Intervals)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code></pre>
</div>
<p>Looking at this graph, it’s clearer that there is a large spike of
check-ins early in the morning (between 7AM and 8AM). If you were to
only look at the bar plot or 1-bin histogram, however, you may have
assumed check-ins kept about the same rate throughout the whole morning
(7AM - 10AM)!</p>
</div>
<div class="section level2">
<h2 id="visualizing-location-data-with-maps">Visualizing Location Data with Maps<a class="anchor" aria-label="anchor" href="#visualizing-location-data-with-maps"></a></h2>
<p>When working with geographic or location data, it’s often useful to
visualize it on a map. Throughout the next section, we’ll demonstrate
ways to work with spacial data using the Game of Thrones Dataset!</p>
<p>First, let’s load the <code>sf</code> package. This package allows
gpplot2 to work with spacial data (like shape files):</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">sf</span><span class="op">)</span></span></code></pre>
</div>
<p>Next, let’s load in the map data containing our map polygons:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#read in data and save to object</span></span>
<span><span class="va">westeros_map</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"polygons_GoT.geojson"</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#look at the data structure</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">westeros_map</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p>Finally, let’s load the voting data and link it to our map data using
the <code>merge</code> function. This function allows for two tibbles to
be linked based off of a specified variable (in our case, the “id”):</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#read in data and save to object</span></span>
<span><span class="va">got_votes</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"voting_GoT.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#look at the data structure</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">got_votes</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#join data using the merge function</span></span>
<span><span class="va">westeros_voting</span> <span class="op">&lt;-</span> <span class="fu">merge</span><span class="op">(</span><span class="va">westeros_map</span>, <span class="va">got_votes</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="map-introduction">Map Introduction<a class="anchor" aria-label="anchor" href="#map-introduction"></a></h3>
<p>Now that our data is ready to be mapped, let’s start by visualizing
which regions favor Jon Snow over Daenerys Targaryen.</p>
<p>When using spacial data, we use a special ggplot function called
<code>geom_sf</code>. Simply, this tells ggplot to look at the simple
features (like lines or polygons) in your data and use that for the
graph!</p>
<p>Below, we will be using <code>geom_sf</code> on our combined data and
use Jon_Snow_pct to determine the level of support Jon Snow is getting
from each region:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">westeros_voting</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Jon_Snow_pct</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"lightblue"</span>, high <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Support for Jon Snow across Westeros"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Support %"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Next, let’s do the same for Daenerys Targaryen, but with red instead
of blue for the color scale:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a map colored by Daenerys support</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">westeros_voting</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Daenerys_Targaryen_pct</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"pink"</span>, high <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Support for Daenerys Targaryen across Westeros"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Support %"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="conditional-map-coloring">Conditional Map Coloring<a class="anchor" aria-label="anchor" href="#conditional-map-coloring"></a></h3>
<p>Often, it may be more beneficial to color each part of the map
according to the candidate that received the most votes, rather than
displaying the amount of support a single candidate received.</p>
<p>This can be achieved by determining which candidate received the most
votes and filling that section with that candidate’s color using the
<code>scale_fill_manual</code> function:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create a column with the name of the dominant candidate</span></span>
<span><span class="va">westeros_voting</span><span class="op">$</span><span class="va">dominant</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">westeros_voting</span><span class="op">$</span><span class="va">Jon_Snow_pct</span> <span class="op">&gt;</span> <span class="va">westeros_voting</span><span class="op">$</span><span class="va">Daenerys_Targaryen_pct</span>, </span>
<span>                                  <span class="st">"Jon Snow"</span>, <span class="st">"Daenerys Targaryen"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#pick fill colors based on the dominant candidate</span></span>
<span><span class="va">dom_color</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Jon Snow"</span> <span class="op">=</span> <span class="st">"steelblue"</span>, </span>
<span>               <span class="st">"Daenerys Targaryen"</span> <span class="op">=</span> <span class="st">"firebrick"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#create a map with the specified coloring</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">westeros_voting</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">dominant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Dominant Candidate"</span>, values <span class="op">=</span> <span class="va">dom_color</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dominant Candidate by Region"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>In some cases, you may not just be interested in who won each region,
but additionally by how much. To map this, first determine the margin of
victory and add a column containing how strong of a victory they
had:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#calculate margin of victory</span></span>
<span><span class="va">westeros_voting</span><span class="op">$</span><span class="va">margin</span> <span class="op">&lt;-</span> <span class="fu">abs</span><span class="op">(</span><span class="va">westeros_voting</span><span class="op">$</span><span class="va">Jon_Snow_pct</span> <span class="op">-</span> <span class="va">westeros_voting</span><span class="op">$</span><span class="va">Daenerys_Targaryen_pct</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#bin the margin into three levels (low, med, high)</span></span>
<span><span class="va">westeros_voting</span><span class="op">$</span><span class="va">margin_bin</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span></span>
<span>  <span class="va">westeros_voting</span><span class="op">$</span><span class="va">margin</span> <span class="op">&lt;=</span> <span class="fl">5</span>, <span class="st">"Low"</span>,</span>
<span>  <span class="fu">ifelse</span><span class="op">(</span><span class="va">westeros_voting</span><span class="op">$</span><span class="va">margin</span> <span class="op">&lt;=</span> <span class="fl">20</span>, <span class="st">"Med"</span>,</span>
<span>         <span class="st">"High"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Using the information you gained above, you can now develop your
“fill rule” and select the color that corresponds to each instance. In
this case, your “fill rule” consists of the winner of each region (ie.
Jon Snow) and how high of a margin of victory they had (ie. High):</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#make a fill rule (ie. Jon Snow - High)</span></span>
<span><span class="va">westeros_voting</span><span class="op">$</span><span class="va">marg_fill</span> <span class="op">&lt;-</span> <span class="fu">paste</span><span class="op">(</span><span class="va">westeros_voting</span><span class="op">$</span><span class="va">dominant</span>, <span class="va">westeros_voting</span><span class="op">$</span><span class="va">margin_bin</span>, sep <span class="op">=</span> <span class="st">" - "</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#pick fill colors based on the fill rule!</span></span>
<span><span class="va">marg_color</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="st">"Daenerys Targaryen - High"</span> <span class="op">=</span> <span class="st">"brown4"</span>,</span>
<span>  <span class="st">"Daenerys Targaryen - Med"</span> <span class="op">=</span> <span class="st">"firebrick"</span>,</span>
<span>  <span class="st">"Daenerys Targaryen - Low"</span> <span class="op">=</span> <span class="st">"pink"</span>,</span>
<span>  <span class="st">"Jon Snow - High"</span> <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>  <span class="st">"Jon Snow - Med"</span> <span class="op">=</span> <span class="st">"royalblue"</span>,</span>
<span>  <span class="st">"Jon Snow - Low"</span> <span class="op">=</span> <span class="st">"lightblue"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Your final step is to combine your fill rule and chosen colors with
your mapping information, creating your margin of victory map:</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create margin of victory map</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">westeros_voting</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">marg_fill</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Winner &amp; Margin"</span>, values <span class="op">=</span> <span class="va">marg_color</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Margin of Victory in Each Region"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="adding-map-labels">Adding Map Labels<a class="anchor" aria-label="anchor" href="#adding-map-labels"></a></h3>
<p>After ensuring your map includes all the information required, the
final step is adding region labels! Unfortunately, due to the nature of
polygons, this is a bit more difficult than simply using the
<code>labs</code> function.</p>
<p>To add region labels, your first step is to convert your data to an
simple feature, also known as an sf, object. This will allow for the
calculation of where your labels will sit on your map:</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#convert to sf</span></span>
<span><span class="va">westeros_voting_sf</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">westeros_voting</span><span class="op">)</span></span></code></pre>
</div>
<p>Your second step is to determine where your region labels will sit on
your map! This is completed by calculating
the<code>r</code>gdef(‘centroid’, ‘centroids’)`, or center points, of
each region. Below, we will calculate the centroid of each region and
convert its x and y coordinates to columns for easier access:</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#calculate centroid</span></span>
<span><span class="va">region_centroids</span> <span class="op">&lt;-</span> <span class="fu">st_centroid</span><span class="op">(</span><span class="va">westeros_voting_sf</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#extract the coordinates</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu">st_coordinates</span><span class="op">(</span><span class="va">region_centroids</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#convert coordinates to columns coords.X and coords.Y</span></span>
<span><span class="va">region_centroids</span><span class="op">$</span><span class="va">coords.X</span> <span class="op">&lt;-</span> <span class="va">coords</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">region_centroids</span><span class="op">$</span><span class="va">coords.Y</span> <span class="op">&lt;-</span> <span class="va">coords</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<p>Now that we have determined where the region labels will be placed,
we can finally add the region labels onto the map using the
<code>geom_text</code> function.</p>
<p>Within this function, we can specify the data used (in this case,
<code>region_centroids</code>), the coordinates, the information that
will be used for the label, and text formatting information (like size
and bold/italics)!</p>
<p>Additionally, it’s important to note that we need to use
<code>westeros_voting_sf</code> as the data for the map instead of
<code>westeros_voting</code>. This will ensure that the region labels
will properly sit on their proper locations!</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create a map with the specified coloring</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">westeros_voting_sf</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">dominant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">region_centroids</span>, </span>
<span>            <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">coords.X</span>, y <span class="op">=</span> <span class="va">coords.Y</span>, label <span class="op">=</span> <span class="va">Name</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">2</span>, fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Dominant Candidate"</span>, values <span class="op">=</span> <span class="va">dom_color</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dominant Candidate by Region"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>As you may notice, some labels in dense areas are overlapping a lot!
This is due to the size of the map in your local version of R. To
resolve this, you can export the map at a larger size using
<code>ggsave</code> (which will be covered at the end of this
lesson!).</p>
</div>
</div>
</div>
</div>
</div>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Using what you’ve learned above, create a map displaying the peak
check-in wait times across the first 35 precincts. For this lesson, we
will be using the <code>avg_checkins.csv</code> file we created within
“Data Wrangling with dplyr”!</p>
<p>To complete this map, use the following steps: 1. Read in your data
as “checkin_data”. 2. Using the <code>merge</code> function, link
together your “checkin_data” with the “westeros_map”, creating a
“westeros_checkins” dataframe. Hint: if the linking columns are named
differently, use by.x and by.y to specify the two names (with x being
the first data and y being the second). 3. Generate your map based on
the “westeros_checkins” data, filling each region based on the
avg_checkin_length. 4. Choose a title and change the name of the legend
to “Check-In Times”.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#read in data</span></span>
<span><span class="va">checkin_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"avg_checkins.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#link together map and checkin_data</span></span>
<span><span class="va">westeros_checkins</span> <span class="op">&lt;-</span> <span class="fu">merge</span><span class="op">(</span><span class="va">westeros_map</span>, <span class="va">checkin_data</span>, by.x <span class="op">=</span> <span class="st">"id"</span>, by.y <span class="op">=</span> <span class="st">"precinct"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#generate map with labels</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">westeros_checkins</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">avg_checkin_length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Average Check-In Times Across Westeros"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Check-In Times"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="customization">Customization<a class="anchor" aria-label="anchor" href="#customization"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="ggplot2-themes">
<strong><code>ggplot2</code></strong> Themes<a class="anchor" aria-label="anchor" href="#ggplot2-themes"></a></h3>
<p>In addition to <code>theme_bw()</code>, which changes the plot
background to white, <strong><code>ggplot2</code></strong> comes with
several other themes which can be useful to quickly change the look of
your visualization. The complete list of themes is available at <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">https://ggplot2.tidyverse.org/reference/ggtheme.html</a>.
<code>theme_minimal()</code> and <code>theme_light()</code> are popular,
and <code>theme_void()</code> can be useful as a starting point to
create a new hand-crafted theme.</p>
<p>The <a href="https://jrnold.github.io/ggthemes/reference/index.html" class="external-link">ggthemes</a>
package provides a wide variety of options (including an Excel 2003
theme). The <a href="https://exts.ggplot2.tidyverse.org/" class="external-link"><strong><code>ggplot2</code></strong>
extensions website</a> provides a list of packages that extend the
capabilities of <strong><code>ggplot2</code></strong>, including
additional themes.</p>
</div>
<div class="section level3">
<h3 id="custom-themes">Custom Themes<a class="anchor" aria-label="anchor" href="#custom-themes"></a></h3>
<p>If you do not like the themes offered, or you’d like to change a
portion of a theme, you can use the <code>theme()</code> function to
manually customize your maps and plots!</p>
<p>The <code>theme()</code> function allows you to customize all
portions of a ggplot, including the text, title, subtitle, and grids.
You can find the <a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">full list in
the documentation</a> or by using the panel on the right and navigating
to the <code>theme</code> help page (Help &gt; Packages &gt; ggplot2
&gt; theme).</p>
<p>Below, we will be applying a few of these customizations to a plot
from earlier in the lesson:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prop_device</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">prop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Proportion of Check-Ins by Location for Each Device"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p>Note: it is also possible to change the fonts of your plots! If you
are on Windows, you will have to install the <a href="https://github.com/wch/extrafont" class="external-link"><strong><code>extrafont</code></strong>
package</a> before doing so..</p>
<p>Additionally, you like the changes you created better than the
default themes, you can save your changes as a custom theme for
application to other plots:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_theme</span> <span class="op">&lt;-</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">prop_hour_device</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Proportion of Check-Ins by Hour for Each Device"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Hour (24H Format)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">my_theme</span></span></code></pre>
</div>
<p>These themes can also be applied to maps, as seen below:</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">westeros_voting</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">dominant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Dominant Candidate"</span>, values <span class="op">=</span> <span class="va">dom_color</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dominant Candidate by Region"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">my_theme</span></span></code></pre>
</div>
<div id="exercise-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>With all of this information in hand, please take another five
minutes to either improve one of the plots generated in this exercise or
create a beautiful graph of your own using any of the data used
throughout this lesson.</p>
<p>You can use the RStudio <a href="https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf" class="external-link"><strong><code>ggplot2</code></strong>
cheat sheet</a> for inspiration.</p>
<p>Here are some ideas: - Make a line plot showing the cumulative number
of check-ins over the course of the day. - Try using a different color
palette for your device comparison. - Generate a new map using the GoT
data.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="plot-output">Plot Output<a class="anchor" aria-label="anchor" href="#plot-output"></a></h2>
<hr class="half-width"><p>After creating a plot, you may want to save it as a png (or other
format). To do this, you can use the use the <code>ggsave()</code>
function, which allows you to easily change the dimension and resolution
of your plot by adjusting the appropriate arguments (<code>width</code>,
<code>height</code> and <code>dpi</code>) before saving the plot to the
specified directory.</p>
<p>Here, we will save one of the plots we customized above:</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">prop_device</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">filter</span><span class="op">(</span><span class="va">location</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"LOCATION_001"</span>, <span class="st">"LOCATION_002"</span>, <span class="st">"LOCATION_003"</span>, <span class="st">"LOCATION_004"</span>, <span class="st">"LOCATION_005"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">mutate</span><span class="op">(</span>location <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">location</span>, <span class="st">"LOCATION_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">mutate</span><span class="op">(</span>device <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">device</span>, <span class="st">"DEVICE_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">prop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">device</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Proportion of Check-Ins by Location for Each Device"</span>,</span>
<span>             x <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>             y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>             fill <span class="op">=</span> <span class="st">"Device"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">theme</span><span class="op">(</span></span>
<span>          text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>          plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>          axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>,</span>
<span>          panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>          panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>          panel.border <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"fig-output/device_prop.png"</span>, <span class="va">plot</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">6</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre>
</div>
<p>You can find the png generated in your data folder!</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul><li>
<code>ggplot2</code> is a flexible and useful tool for creating
plots in R.</li>
<li>The data set and coordinate system can be defined using the
<code>ggplot</code> function.</li>
<li>Additional layers, including geoms, are added using the
<code>+</code> operator.</li>
<li>Time-series data can be visualized using <code>geom_line()</code>
and <code>geom_point()</code>.</li>
<li>Box plots are useful for visualizing the distribution of check-in
times by location.</li>
<li>Bar plots are useful for visualizing counts of check-ins by
categorical variables.</li>
<li>Faceting allows you to generate multiple plots based on a
categorical variable like device.</li>
<li>Spatial data can be visualized on maps using the <code>sf</code> and
<code>ggplot2</code> packages.</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/04-tidyr.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/06-rmarkdown.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/04-tidyr.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Data Wrangling with
        </a>
        <a class="chapter-link float-end" href="../instructor/06-rmarkdown.html" rel="next">
          Next: Getting Started with...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/EngineeringForDemocracy/r-election-workers/edit/main/episodes/05-ggplot2.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/EngineeringForDemocracy/r-election-workers/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/EngineeringForDemocracy/r-election-workers/" class="external-link">Source</a></p>
				<p><a href="https://github.com/EngineeringForDemocracy/r-election-workers/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:brownsarahm@uri.edu">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.17.1" class="external-link">sandpaper (0.17.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/EngineeringForDemocracy/varnish/tree/6ac3eaac4a59239c73c7a278964f1b9076933e28" class="external-link">varnish (1.0.7)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://EngineeringForDemocracy.github.io/r-election-workers/instructor/05-ggplot2.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Data Visualisation with ggplot2",
  "creativeWorkStatus": "active",
  "url": "https://EngineeringForDemocracy.github.io/r-election-workers/instructor/05-ggplot2.html",
  "identifier": "https://EngineeringForDemocracy.github.io/r-election-workers/instructor/05-ggplot2.html",
  "dateCreated": "2025-11-10",
  "dateModified": "2025-11-12",
  "datePublished": "2025-11-12"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

